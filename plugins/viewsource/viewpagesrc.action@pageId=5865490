                    
    
                    
    
                    
    
<!DOCTYPE html>
<html>
    <head>
        <title>查看源</title>
        <link rel="canonical" href="/confluence/pages/viewpage.action?pageId=5865490" />
        <link type="text/css" rel="stylesheet" href="/confluence/s/d41d8cd98f00b204e9800998ecf8427e/zh_CN-1988229788/4726/ae47f2be84292af5a42aed58ebcd4cb49e436f6e.4/24/_/download/superbatch/css/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="/confluence/s/d41d8cd98f00b204e9800998ecf8427e/zh_CN-1988229788/4726/ae47f2be84292af5a42aed58ebcd4cb49e436f6e.4/24/_/download/superbatch/css/batch.css?media=print" media="print">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/confluence/s/d41d8cd98f00b204e9800998ecf8427e/zh_CN-1988229788/4726/ae47f2be84292af5a42aed58ebcd4cb49e436f6e.4/24/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 8]>
<link type="text/css" rel="stylesheet" href="/confluence/s/d41d8cd98f00b204e9800998ecf8427e/zh_CN-1988229788/4726/ae47f2be84292af5a42aed58ebcd4cb49e436f6e.4/24/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+8" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/confluence/s/d41d8cd98f00b204e9800998ecf8427e/zh_CN-1988229788/4726/ae47f2be84292af5a42aed58ebcd4cb49e436f6e.4/24/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="/confluence/s/d41d8cd98f00b204e9800998ecf8427e/zh_CN-1988229788/4726/ae47f2be84292af5a42aed58ebcd4cb49e436f6e.4/540325f998b5a41b60b4c19911f6a7d9/_/download/contextbatch/css/plugin.viewsource/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="/confluence/s/d41d8cd98f00b204e9800998ecf8427e/zh_CN-1988229788/4726/ae47f2be84292af5a42aed58ebcd4cb49e436f6e.4/5d7c5b6c1e8dc6bb7107b4e4a2d2e0e5/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/confluence/s/d41d8cd98f00b204e9800998ecf8427e/zh_CN-1988229788/4726/ae47f2be84292af5a42aed58ebcd4cb49e436f6e.4/5d7c5b6c1e8dc6bb7107b4e4a2d2e0e5/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="/confluence/s/d41d8cd98f00b204e9800998ecf8427e/zh_CN-1988229788/4726/ae47f2be84292af5a42aed58ebcd4cb49e436f6e.4/79c738f4bfcbaa104651b3a3b7065227/_/download/contextbatch/css/editor-content/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="/confluence/s/d41d8cd98f00b204e9800998ecf8427e/zh_CN-1988229788/4726/ae47f2be84292af5a42aed58ebcd4cb49e436f6e.4/1.3/_/download/batch/com.atlassian.confluence.plugins.confluence-highlight-actions:highlighting-experiment-resources/com.atlassian.confluence.plugins.confluence-highlight-actions:highlighting-experiment-resources.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/confluence/s/d41d8cd98f00b204e9800998ecf8427e/zh_CN-1988229788/4726/ae47f2be84292af5a42aed58ebcd4cb49e436f6e.4/1.3/_/download/batch/com.atlassian.confluence.plugins.confluence-highlight-actions:highlighting-experiment-resources/com.atlassian.confluence.plugins.confluence-highlight-actions:highlighting-experiment-resources.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="/confluence/s/zh_CN-1988229788/4726/ae47f2be84292af5a42aed58ebcd4cb49e436f6e.4/1/_/styles/colors.css?spaceKey=Lvmama" media="all">
<link type="text/css" rel="stylesheet" href="/confluence/s/zh_CN-1988229788/4726/ae47f2be84292af5a42aed58ebcd4cb49e436f6e.4/1.0/_/download/resources/com.atlassian.confluence.themes.default:styles/default-theme.css" media="all">

    </head>

    <body class="mceContentBody aui-theme-default wiki-content fullsize">
        <p>&nbsp;</p>         <h3>Ø  功能说明</h3><p>此功能模块主要是负责系统中所有短信的发送工作。</p><h3>Ø  业务逻辑</h3><p> <img class="confluence-embedded-image" src="/confluence/download/attachments/5865490/image2014-5-21%2012%3A57%3A48.png?version=1&amp;modificationDate=1400648282000&amp;api=v2" data-image-src="/confluence/download/attachments/5865490/image2014-5-21%2012%3A57%3A48.png?version=1&amp;modificationDate=1400648282000&amp;api=v2" data-linked-resource-id="5996548" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2014-5-21 12:57:48.png" data-base-url="http://10.2.1.106:8080/confluence" data-linked-resource-container-id="5865490" title="驴妈妈技术平台知识库 > SMS > image2014-5-21 12:57:48.png" data-location="驴妈妈技术平台知识库 > SMS > image2014-5-21 12:57:48.png"></p><p>将需要发送的内容抽取出来放入短信模板表中，发送短信的时候查询短信模板表，再结合一些动态参数组成最终需要发送的内容，将内容存储到短信内容表中，由短信定时器来轮询该表完成短信的发送操作。</p><p>带发送的短信存储在lvmama_pet.sms_content表中，短信发送完成以后将被移到lvmama_pet.sms_content_log表中，可以结合手机号码在这两个表中查询短信的发送信息。</p><p>目前系统的相关管理后台在pet_back中（订单管理-&gt;短信管理中）.</p><p>目前驴妈妈相关的短信分为两块：营销短信也业务相关的短信，营销短信由梦网来发送，业务相关短信由亿美和点点客来发送，</p><p>短信通道目前有以下几种：</p><p>1)     亿美彩信：主要负责发送彩信</p><p>2)     亿美普通短信：主要用以发送业务相关的短信，被发送的内容结尾必须加上【驴妈妈】</p><p>3)     点点客：亿美普通短信的备用通道</p><p>4)     梦网：主要负责营销短信的发送</p><h3>Ø  相关代码</h3><p><em><u>//</u></em><em><u>提供短信发送的各种方法</u></em></p><p>com.lvmama.pet.sms.service.SmsServiceImpl</p><p>//短信相关的job</p><p>com.lvmama.pet.job.quartz.sms.AbstractSendJob</p><p>亿美彩信发送</p><p>com.lvmama.pet.job.quartz.sms.EMayMMSSendJob</p><p>亿美普通短信发送</p><p>com.lvmama.pet.job.quartz.sms.EMaySendJob</p><p>梦网短信发送（主要发送营销短信）</p><p>com.lvmama.pet.job.quartz.sms.MontnetsSendJob</p><p>点点客短信发送</p><p>com.lvmama.pet.job.quartz.sms.DoDoCaSendJob</p><h3>Ø  相关表</h3><p align="left"><em>--</em><em>短信模板表</em></p><p align="left">select * from lvmama_pet.com_sms_template;</p><p>select * from lvmama_super.PROD_CHANNEL_SMS;</p><p align="left"><em>--</em><em>短信内容表,此表用于存放待发送的短信</em></p><p align="left">select * from lvmama_pet.sms_content;</p><p align="left"><em>--</em><em>短信内容日志表，已发送或者发送失败的短信会从sms_content表移到该表中</em></p><p>select * from lvmama_pet.sms_content_log;</p><p align="left"><em>--</em><em>短信全局配置表,用以配置短信发送通道的一些信息</em></p><p>select * from lvmama_pet.sms_config;</p><p> </p><p>短信相关文档可以查看<a href="http://192.168.0.7/svn/SCM/技术中心文档库/用户关系组/短信">《短信相关》</a></p>
        <p>&nbsp;</p>
    </body>
</html>
